define(["backbone","marionette","hbs!app/applets/medication_review/list/medicationGroup","app/applets/medication_review/list/medicationView","app/applets/medication_review/appletHelper","app/applets/medication_review/medicationCollectionHandler"],function(e,t,i,a,l,o){var s=e.Marionette.ItemView.extend({template:_.template('<h5 id="medsLoadingDiv"><i class="fa fa-spinner fa-spin"></i> Loading...</h5>')}),n=e.Marionette.ItemView.extend({template:_.template('<span class="col-layout-md"><strong>No Records</strong></span>')}),d=e.Marionette.CompositeView.extend({template:i,className:"list-group",childView:a,childViewContainer:".panel-body",initialize:function(e){this.collection=e.model.get("meds"),this.groupByName(this.collection)},groupByName:function(){var t=this.collection.groupBy(function(e){var t=l.getMedicationGroupbyData(e).groupbyValue+l.getMedicationGroupbyData(e).groupbyFacility;return t}),i=_.map(t,function(t,i){return new e.Model({type:i,meds:new e.Collection(t),name:t[0].get("name"),sig:t[0].get("sig"),dose:t[0].get("dose"),dosagesUnits:t[0].get("dosagesUnits"),routeName:t[0].get("routeName"),scheduleName:t[0].get("scheduleName"),overallStop:t[0].get("overallStop"),vaStatus:t[0].get("vaStatus"),instructions:t[0].get("instructions"),detailId:t[0].get("detailId"),lastDate:t[0].get("lastDate"),lastDatePrefix:t[0].get("lastDatePrefix"),lastFillStyle:t[0].get("lastFillStyle"),lastFillDetails:t[0].get("lastFillDetails"),dailyOrScheduledDosePrefix:t[0].get("dailyOrScheduledDosePrefix"),dailyOrScheduledDose:t[0].get("dailyOrScheduledDose"),summaryViewDate:t[0].get("summaryViewDate"),expirationLabel:t[0].get("expirationLabel"),standardizedVaStatus:t[0].get("standardizedVaStatus"),standardizedFacilityCode:t[0].get("standardizedFacilityCode"),subcategory:t[0].get("subcategory"),initialize:function(){this.type=i,this.meds=t}})});this.collection.reset(i)}}),r=e.Marionette.CollectionView.extend({id:"medicationsAccordion",className:"panel-group",childView:d,emptyView:s,initialize:function(){this.collection=new e.Collection,this.listenTo(o.allMedGroups,"reset",function(){this.collection.reset(o.allMedGroups.models),this.collection.length<=0&&(this.emptyView=n,this.render())})}});return r});