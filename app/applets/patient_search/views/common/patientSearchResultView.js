define(["backbone","marionette","jquery","hbs!app/applets/patient_search/templates/singleSearchResultTemplate","hbs!app/applets/patient_search/templates/singleSearchResult_clinicsTemplate","hbs!app/applets/patient_search/templates/singleSearchResult_roomBedIncludedTemplate","hbs!app/applets/patient_search/templates/singleSearchResult_myCPRSListTemplate"],function(e,t,s,a,i,r,l){var c=13,n=32,o="clinics",p="roomBedIncluded",m="myCprsList",h=e.Marionette.ItemView.extend({source:"",tagName:"a",className:"list-group-item row-layout",template:a,attributes:{tabIndex:"0",onclick:"return false",href:""},events:{click:"selectPatient",keyup:"selectPatient"},initialize:function(e){this.searchApplet=e.searchApplet,this.searchApplet.selectedLocationModel&&this.model.set("clinicName",this.searchApplet.selectedLocationModel.get("displayName")),this.source=e.source,e.templateName&&(this.templateName=e.templateName),e.source&&(this.source=e.source)},getTemplate:function(){if(!this.templateName)return a;switch(this.templateName){case o:return i;case p:return r;case m:return l;default:return a}},selectPatient:function(e){if(void 0===e.keyCode||e.keyCode==c||e.keyCode==n){this.model;"global"===this.source&&this.mviGetCorrespondingIds(),s("#patient-search-results a.active").removeClass("active"),s("#patient-search-confirmation").removeClass("hide"),s("#global-search-results a.active").removeClass("active"),s("#global-search-confirmation").removeClass("hide"),s(e.currentTarget).siblings(".active").removeClass("active"),s(e.currentTarget).addClass("active"),this.searchApplet.patientSelected(this.model)}},mviGetCorrespondingIds:function(){var t=s.Deferred(),a=this.model.attributes;a.dob=a.birthDate;var i=e.Model.extend({url:ADK.ResourceService.buildUrl("search-mvi-patient-sync"),defaults:{pid:a.pid,demographics:a}}),r=new i;return r.save({},{success:function(e,s,a){t.resolve(s)}}),t.promise()}});return h});