define(["backbone","marionette","underscore","jquery","hbs!app/applets/vitalsEiE/templates/vitalsEiEBodyTemplate","app/applets/vitalsEiE/views/vitalsEiEHeaderView","app/applets/vitalsEiE/views/vitalsEiEFooterView"],function(e,t,i,a,r,s,o){var l="#vitals-entered-in-error",d="#vitals-reason-for-removal",n="Vitals Entered in Error",p="Your checked item has no id related to mark as entered in error.",c="You must check a vital in order to mark it in error.",m="You must give a reason in order to mark a vital in error.",v=e.Marionette.ItemView.extend({template:r,initialize:function(){this.model=new e.Model({models:[]})},onRender:function(){setTimeout(function(){a('[data-toggle="tooltip"]').tooltip({placement:"right"})},100)},events:{"click input":"validate","blur input":"validate"},showModal:function(e,t){this.model.set("models",t.collection);var r=ADK.UserService.getUserSession().get("site");i.each(this.model.get("models"),function(e){pidSiteCode=e.get("pid")?e.get("pid").split(";")[0]:"",e.get("localId")||e.set("localId",e.get("displayName")+"-no-local-id"),e.get("enteredByName")||(e.attributes.enteredByName="Unavailable"),pidSiteCode!==r?(e.attributes.disabled=!0,e.attributes.labelClass="grayText","BMI"===e.get("displayName")?e.attributes.tooltip=e.get("typeName")+" disabled for edit.<br>Calculated value.":pidSiteCode?e.attributes.tooltip=e.get("typeName")+" disabled for edit.<br>Non-local site.":e.attributes.tooltip=e.get("typeName")+" disabled for edit."):(e.attributes.tooltip=e.get("typeName")+" "+e.get("resultUnits"),e.attributes.disabled=!1)});var l=o.extend({model:this.model.set(t.collection),bodyView:this}),d=s.extend({model:this.model.set("title",t.title),theView:this}),p={size:"large",title:n,headerView:d,footerView:l,regionName:"vitalsEiEDialog"},c=new ADK.UI.Modal({view:this,options:p});c.show(),i.isEmpty(t.checked)||a("input#"+t.checked).prop("checked",!0)},templateHelpers:{otherSite:function(){return!0}},validate:function(e){var t=(a(e.target),[]),r=!1,s=!1;this.resetErrors();var o=a("input[type=checkbox]",this.$el);i.each(o,function(e){var s=a(e);s.prop("checked")===!0&&(r=!0,i.isEmpty(s.prop("id"))===!0&&t.push({el:l,message:p}))});var n=a("input[type=radio]",this.$el);i.each(n,function(e){a(e).prop("checked")===!0&&(s=!0)}),r===!1&&t.push({el:l,message:c}),s===!1&&t.push({el:d,message:m}),valid=i.isEmpty(t),this.disableSave(!valid),valid===!1&&this.displayErrors(t)},disableSave:function(e){var t=ADK.Messaging.getChannel("vitalsEiE");t.command("vitalsEiE:validated",e)},resetErrors:function(){var e=a(".vitals-error");i.each(e,function(e){var t=a(e);t.find(".error-message").remove(),t.removeClass("vitals-error applet-error")})},displayErrors:function(e){i.each(e,function(e){var t=a(e.el);t.addClass("vitals-error"),t.prop("aria-inavalid",!0),t.prepend("<p class='error-message applet-error' aria-atomic='true' tab-index='0'>"+e.message+"</p>")})}});return v});