define(["backbone","marionette","hbs!app/applets/appointments/toolBar/apptsFilterTemplate"],function(t,e,i){"use strict";var s=t.Marionette.ItemView.extend({apptSite:"ALL",initialize:function(t){this.collection=t.collection,this.siteMenuItems=t.siteMenuItems,this.setActiveSite(this.siteMenuItems,"ALL")},template:i,className:"list-group-item row-layout",events:{"click .nav-pills-appts":"filterBySite","keydown .nav-pills-appts":"accessibility"},accessibility:function(t){if(32==t.keyCode){var e="#"+t.currentTarget.id;this.$(e).trigger("click")}},clearSearchText:function(){$("#grid-filter-appointments").find(".clear").click(),ADK.SessionStorage.setAppletStorageModel("appointments","filterText","")},filterBySite:function(t){this.apptSite=t.currentTarget.id,this.filterResults(this.apptSite,this.collection,this.filterValue),this.setActiveSite(this.siteMenuItems,this.apptSite);var e=$(t.currentTarget);return e.closest(".btn-group").find('[data-bind="label"]').text(e.text()),this.clearSearchText(),t.preventDefault(),!0},setActiveSite:function(t,e){for(var i=0;i<t.models.length;i++)t.models[i].get("site")==e?t.models[i].set("active",!0):t.models[i].set("active",!1)},filterResults:function(t,e,i){switch(t){case"LOCAL":ADK.utils.filterCollectionSubstring(e,"uid",i);break;case"ALLVA":ADK.utils.filterCollectionNoSubstring(e,"uid",":DOD:");break;default:ADK.utils.resetCollection(e)}},filterResultsDefault:function(t){return this.filterResults(this.apptSite,t,this.filterValue)},isAppointment:function(t){var e=!1,i=!1;return t.get("appointmentStatus")&&(e=t.get("appointmentStatus").indexOf("FUTURE")>-1||t.get("appointmentStatus").indexOf("CANCELLED")>-1),t.get("categoryName")&&(i=t.get("categoryName").indexOf("Appointment")>-1),e||i},onRender:function(){$("#grid-panel-appointments").css({overflow:"visible"}),this.$el.html(this.template({siteitems:this.siteMenuItems.toJSON()}));var t=this.siteMenuItems.findWhere({active:!0});this.$("#appts-site-menu-btn-label-span").text(t.get("siteLabel"))}});return s});