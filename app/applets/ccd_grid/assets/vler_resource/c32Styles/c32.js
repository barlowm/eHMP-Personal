function addLoadEvent(e){var t=window.onload;"function"!=typeof window.onload?window.onload=e:window.onload=function(){t&&t(),e()}}function addUnloadEvent(e){var t=window.onunload;"function"!=typeof window.onunload?window.onunload=e:window.onunload=function(){t&&t(),e()}}function showHelp(e){openNewWindow(e,"Help")}function getComponentWithClass(e,t,n){if(null===e||null===t)return null;null===n&&(n=document);var l=n.getElementsByTagName(e);if(null===l||l.length<1)return null;for(var i=0;i<l.length;i++)if(null!==l[i].className&&l[i].className.indexOf(t)>-1)return l[i];return null}function viewDetail(e,t,n){null===t&&(t=dwidth_default),null===n&&(n=dwidth_default),setupTimeout(),window.onunload=closeDetailDialog,null!==dlgDetail&&dlgDetail.close(),dlgDetail=getDialogWindow(e,"viewDetail",t,n)}function getDialogWindow(e,t,n,l){n=dwidth_default,null===l&&(l=dwidth_default),null===t&&(t="vwDialog");var i=null;return window.showModelessDialog?i=window.showModelessDialog(e,t,"center=yes;dialogHeight="+l+"px;dialogWidth="+n+"px;help=no;resizable=yes"):window.openDialog?(i=openAsDialog(e,t,n,l),i.focus()):window.open?(i=openAsDialog(e,t,n,l),i.focus()):alert("Popup dialogs not supported for this browser"),i}function openAsDialog(e,t,n,l){return null===n&&(n=dwidth_default),null===l&&(l=dwidth_default),window.open(e,t,"resizable=yes,scrollbars=yes,status=no,dependent=yes,height="+l+",width="+n+",top=100,left=200")}function openNewWindow(e,t,n,l){return null===n&&(n=dwidth_default),null===l&&(l=dwidth_default),window.open(e,t,"resizable=yes,scrollbars=yes,status=yes,dependent=no,height="+l+",width="+n+",top=100,left=200")}function closeDetailDialog(){closePrintDlgIfOpen(),null!==dlgDetail&&dlgDetail.close()}function printReport(){if(closePrintDlgIfOpen(),dlgDetailPrint=getDialogWindow("blank.htm","printReport"),null===dlgDetailPrint)return void alert("Print window could not be opened");var e=findDocWithPatientData(),t=dlgDetailPrint.contentDocument;(void 0===t||null===t)&&(t=dlgDetailPrint.document),t.open();var n,l;buildHeader(t,e);var i=document.getElementById("siteReportsMenu");if(i){if(i){n=document.all?document.all:document.getElementsByTagName?document.getElementsByTagName("*"):[];for(var d=0;d<n.length;d++)"sitePanel"===n[d].className&&(l=n[d],t.write(l.innerHTML))}}else{var a=document.getElementById("aDiv");if(void 0===a||null===a){if(l=document.getElementById("siteDiv0"),void 0===l||null===l){l=document.getElementById("GraphPanel");var o=l.getElementsByTagName("A");l.removeChild(o[0])}}else l=a.cloneNode(!0),removeAnchors(l),maybeRemoveColumn(l,"View Details"),maybeRemoveColumn(l,"AWIV");t.write(l.innerHTML)}buildFooter(t,e),t.close(),dlgDetailPrint.focus(),dlgDetailPrint.print()}function findDocWithPatientData(){return null!==getPatientLabel(document)?document:null!==parent&&null!==getPatientLabel(parent.document)?parent.document:void 0}function removeAnchors(e){for(var t=e.getElementsByTagName("tr")[0],n=t.getElementsByTagName("th"),l=0;l<n.length;l++){var i=n[l],d=i.getElementsByTagName("a")[0],a=" ";d&&(a=d.childNodes[0].nodeValue,i.removeChild(d));var o=document.createTextNode(a);i.appendChild(o)}}function maybeRemoveColumn(e,t){var n=e.getElementsByTagName("tr");if(!(null===n||n.length<1)){var l=n[0].getElementsByTagName("th");if(!(null===l||l.length<1))for(var i=0;i<l.length;i++)if(l[i].innerHTML.indexOf(t)>-1){removeColumn(n,i);break}}}function removeColumn(e,t){e[0].removeChild(e[0].getElementsByTagName("th")[t]);for(var n=1;n<e.length;n++)e[n].removeChild(e[n].getElementsByTagName("td")[t])}function getPatientLabel(e){return e.getElementById("PatientLabel")}function buildHeader(e,t){var n=getPatientLabel(t),l=n.innerHTML,i=l.search(/\d{3}\D\d{2}\D\d{4}/),d=l.substring(0,i-2),a=l.substring(i+7,i+11);a="***-**-"+a;var o=e.createElement("table"),r=e.createElement("tbody"),p=e.createElement("tr"),c=e.createElement("td"),s=e.createTextNode("VistAWeb"),u=e.createElement("font");u.appendChild(s),c.appendChild(u),c.align="center",c.width="40%",c.setAttribute("style","font-size:small");var g=e.createElement("td"),m=getComponentWithClass("IMG","pageTitleImage",t),h=e.createElement("img");null!==m?h.src=m.src:h.src="resources/images/blank.gif",g.appendChild(h),g.width="30%";var f=e.createElement("td"),b=new Date,w=b.getMonth();w++;var D=e.createTextNode(w+"/"+b.getDate()+"/"+b.getFullYear()),v=e.createElement("font");v.appendChild(D),f.appendChild(v),f.align="center",f.width="30%",f.setAttribute("style","font-weight:bold"),p.appendChild(c),p.appendChild(g),p.appendChild(f);var y=e.createElement("tr"),E=e.createElement("td"),C=e.createTextNode(d);E.appendChild(C),E.align="center";var T=e.createElement("td"),P=e.createTextNode(a);T.appendChild(P),T.align="center";var x=e.createElement("td"),N=t.getElementById("lblDOB"),_=e.createTextNode("DOB:  "+N.innerHTML);x.appendChild(_),x.align="center",y.appendChild(E),y.appendChild(T),y.appendChild(x);var B=e.createElement("table"),I=e.createElement("tbody"),H=e.createElement("tr"),L=e.createElement("td"),A=e.createTextNode("***WARNING: Printed grid reports may not show all columns.  Check printouts carefully.");L.appendChild(A),L.align="center",L.width="100%",H.appendChild(L),r.appendChild(p),r.appendChild(y),o.appendChild(r),o.setAttribute("width","100%"),o.setAttribute("border","0"),o.setAttribute("bgcolor","silver"),I.appendChild(H),B.appendChild(I),B.setAttribute("width","100%"),B.setAttribute("border","0"),B.setAttribute("bgcolor","silver"),e.write(o.outerHTML),e.write(B.outerHTML)}function buildFooter(e,t){var n=e.createElement("table"),l=e.createElement("tbody"),i=e.createElement("tr"),d=e.createElement("td"),a=t.getElementById("lblUserName"),o=e.createTextNode("Printed by:  "+a.innerHTML);d.appendChild(o),d.width="70%",i.appendChild(d),l.appendChild(i),n.appendChild(l),n.width="100%",n.border="0",n.bgcolor="silver",e.write(n.outerHTML)}function printStuff(){closePrintDlgIfOpen(),dlgDetailPrint=getDialogWindow("DetailsPrint.aspx?"+location.search.substring(1),"printStuff")}function closePrintDlgIfOpen(){null!==dlgDetailPrint&&dlgDetailPrint.close()}function printDetail(){if(closePrintDlgIfOpen(),dlgDetailPrint=getDialogWindow("blank.htm","printDetail"),null===dlgDetailPrint)return void alert("Print window could not be opened");var e=dlgDetailPrint.contentDocument;(void 0===e||null===e)&&(e=dlgDetailPrint.document),e.open();var t=this.document;buildDtlHeader(e,t);var n=document.getElementById("aDiv"),l=n.cloneNode(!0);e.write(l.innerHTML),buildDtlFooter(e,t),e.close(),dlgDetailPrint.focus(),dlgDetailPrint.print()}function buildDtlHeader(e,t){var n=t.getElementById("PatientLabel"),l=n.childNodes[0].data,i=l.search(/\d{3}\D\d{2}\D\d{4}/),d=l.substring(0,i-2),a=l.substring(i+7,i+11);a="***-**-"+a;var o=e.createElement("table"),r=e.createElement("tbody"),p=e.createElement("tr"),c=e.createElement("td"),s=e.createTextNode("VistAWeb"),u=e.createElement("font");u.appendChild(s),c.appendChild(u),c.align="center",c.width="40%",c.setAttribute("style","font-size:small");var g=e.createElement("td"),m=e.createTextNode(document.getElementById("gridDesc").childNodes[0].data),h=e.createElement("font");h.appendChild(m),g.appendChild(h),g.align="center",h.setAttribute("size","3"),g.setAttribute("style","font-size:large"),g.width="30%";var f=e.createElement("td"),b=new Date,w=b.getMonth();w++;var D=e.createTextNode(w+"/"+b.getDate()+"/"+b.getFullYear()),v=e.createElement("font");v.appendChild(D),f.appendChild(v),f.align="center",f.width="30%",f.setAttribute("style","font-weight:bold"),p.appendChild(c),p.appendChild(g),p.appendChild(f);var y=e.createElement("tr"),E=e.createElement("td"),C=e.createTextNode(d);E.appendChild(C),E.align="center";var T=e.createElement("td"),P=e.createTextNode(a);T.appendChild(P),T.align="center";var x=e.createElement("td"),N=t.getElementById("lblDOB"),_=e.createTextNode("DOB:  "+N.innerHTML);x.appendChild(_),x.align="center",y.appendChild(E),y.appendChild(T),y.appendChild(x),r.appendChild(p),r.appendChild(y),o.appendChild(r),o.setAttribute("width","100%"),o.setAttribute("border","0"),o.setAttribute("bgcolor","silver"),e.write(o.outerHTML)}function buildDtlFooter(e,t){var n=e.createElement("table"),l=e.createElement("tbody"),i=e.createElement("tr"),d=e.createElement("td"),a=t.getElementById("lblUserName"),o=e.createTextNode("Printed by:  "+a.innerHTML);d.appendChild(o),d.width="70%",i.appendChild(d),l.appendChild(i),n.appendChild(l),n.width="100%",n.border="0",n.bgcolor="silver",e.write(n.outerHTML)}function toClipboard(){window.clipboardData.clearData(),window.clipboardData.setData("Text",document.getElementById("TextVersion").value)}function maybeStartCheck(){"undefined"!=typeof ajax&&checkPage()}function trimString(e){return e=this!==window?this:e,e.replace(/^\s+/g,"").replace(/\s+$/g,"")}function findPosX(e){var t=0;if(e.offsetParent)for(;;){if(t+=e.offsetLeft,!e.offsetParent)break;e=e.offsetParent}else e.x&&(t+=e.x);return t}function findPosY(e){var t=0;if(e.offsetParent)for(;;){if(t+=e.offsetTop,!e.offsetParent)break;e=e.offsetParent}else e.y&&(t+=e.y);return t}function HideTip(){tip_box_id.style.display="none"}function ShowTip(){tip_box_id.style.display="block"}function ToggleTip(){"none"==tip_box_id.style.display?ShowTip():"block"==tip_box_id.style.display&&HideTip()}function DisplayTip(e,t,n,l,i){var d,a,o=e.innerHTML,r=e.parentNode.offsetWidth,p=e.innerHTML.length;if(10*(p-1)>r){var c=e;tip_box_id=document.getElementById(TipBoxID);var s=findPosX(e),u=findPosY(e);"1"==l?(d=s+t-300,0>d&&(d=0),a=u+n+75,tip_box_id.style.left=String(parseInt(d)+"px"),tip_box_id.style.top=String(parseInt(a)+"px"),tip_box_id.innerHTML=o,tip_box_id.style.display="none",c.onclick=ToggleTip):(d=s+t-100,0>d&&(d=0),a=u+n-10,tip_box_id.style.left=String(parseInt(d)+"px"),tip_box_id.style.top=String(parseInt(a)+"px"),tip_box_id.innerHTML=o,tip_box_id.style.display="block",c.onmouseout=HideTip)}}var dwidth_default=600,dheight_default=500,dlgDetail=null,dlgDetailPrint=null,timeoutId=null,TipBoxID="TipBox",tip_box_id;