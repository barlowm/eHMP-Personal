define(["backbone","moment"],function(e,t){"use strict";var n=!1,a={dateAggregation:function(e){var t={},a={},i=[],o=[],s={},r="YYYYMMDD",l="YYYYMMDDHHmmssSSS";if(n&&console.log(s),!$.isArray(e))return{msg:"nodata"};if(0===e.length)return{msg:"nodata"};for(var d=0;d<e.length;d++){var u=moment(e[d].attributes.activityDateTime,l).format(r);n&&console.log(u),"undefined"==typeof t[u]?t[u]={total:1,event_types:[],eventsByTypes:{}}:t[u].total++,t[u].event_types.push(e[d].attributes.kind),"undefined"==typeof t[u].eventsByTypes[e[d].attributes.kind]?t[u].eventsByTypes[e[d].attributes.kind]=1:t[u].eventsByTypes[e[d].attributes.kind]=t[u].eventsByTypes[e[d].attributes.kind]+1,"undefined"==typeof a[e[d].attributes.kind]?a[e[d].attributes.kind]=1:a[e[d].attributes.kind]++}n&&console.log(t),n&&console.log(a),n&&console.log("elements in source data set---> "+d);var c=0;for(var p in t)i.push([p,t[p]]),c++;i.sort(function(e,t){return e[0]-t[0]});for(var y in a)o.push([y,a[y]]);return s={msg:"ok",eventsByType:o,agrData:i,nEvents:i.length,firstEvent:i[0][0],lastEvent:i[i.length-1][0]},n&&console.log(s),s},getColorByType:function(e){var t="#FFFF00";switch(e.toLowerCase()){case"consult":t="#0066FF";break;case"immunization":t="#99FFCC";break;case"admission":t="#6600FF";break;case"visit":t="#66FF99";break;case"procedure":t="#006600";break;case"surgery":t="#FF0000";break;case"consult":t="#00CC99";break;case"procedure":t="#FF6600"}return t},chartOptions:{global:{useUTC:!1,timezoneOffset:300},chart:{renderTo:"time-chart-container",animation:!1,height:170,zoomType:"x",resetZoomButton:{relativeTo:"chart",theme:{display:"none"}},type:"column"},rangeSelector:{allButtonsEnabled:!0,selected:1},credits:{enabled:!1},title:{text:"",enabled:!1},xAxis:{labels:{rotation:45,align:"left",overflow:"justify"},type:"datetime",tickWidth:4,minTickInterval:864e5},tooltip:{xDateFormat:"%Y-%m-%d"},plotOptions:{series:{cursor:"pointer",pointWidth:8,pointInterval:864e5},column:{grouping:!1,shadow:!1}},yAxis:[{lineWidth:1,title:{enabled:!0,text:"Events"},tickPositioner:function(){if(null!==this.dataMin&&null!==this.dataMax){var e=[],t=Math.floor(this.dataMin),n=Math.ceil((this.dataMax-this.dataMin)/2);for(t;t-n<=this.dataMax;t+=n)e.push(t);return e}}},{lineWidth:1,opposite:!0,title:{enabled:!0,text:"Events"}}],legend:{enabled:!1,floating:!0,layout:"horizontal",verticalAlign:"middle",align:"right",y:75},series:[{yAxis:0,data:[],name:"events",type:"column"}]}};return a});