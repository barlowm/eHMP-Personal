define(["backbone","marionette","underscore","hbs!app/applets/addAllergy/templates/symptomsViewTemplate","app/applets/addAllergy/utils/symptomsUtil","app/applets/addAllergy/addAllergyGlobals","app/applets/addAllergy/models/symptomsCollection"],function(e,t,o,l,n,i,s){var r=({patient:ADK.PatientRecordService.getCurrentPatient(),resourceTitle:"allergy-op-data-symptoms",criteria:{dir:"1",from:""}},e.Marionette.ItemView.extend({template:l,tagName:"li",className:"",attributes:function(){return{id:"symptom"+this.model.get("count")+"-"+this.model.get("IEN"),style:"cursor:pointer"}},events:{click:"triggerSelectedSymptom",keydown:"triggerSelectedSymptomKeyDown"},triggerSelectedSymptom:function(e){e.preventDefault(),i.addAllergyApplication.vent.trigger(i.events.ADD_SYMPTOMS,this.model),this.remove()},triggerSelectedSymptomKeyDown:function(e){if(13===e.keyCode||32===e.keyCode){e.preventDefault();var t=$($(":focus").parent(),$("#symptoms-ul")).index(),l=$("#symptoms-ul").children().eq(t+1).children();o.defer(function(){0===l.length?$("#symptoms-selected-tbl > tbody").find("input")[0].focus():l.eq(0).focus()}),this.triggerSelectedSymptom(e)}else(9===e.keyCode||39===e.keyCode)&&(e.preventDefault(),e.shiftKey?$("#symptomSearchInput").focus():n.isSelectedSymptomsEmpty()?$("#comments").focus():$("#symptoms-selected-tbl > tbody").find("input")[0].focus())}})),c=e.Marionette.CollectionView.extend({initialize:function(){var e=this;this.collection=new s,this.collection.comparator=function(e){return e.get("name")},i.addAllergyApplication.vent.on(i.events.ADD_SYMPTOMS,function(t){e.collection.remove(t)}),i.addAllergyApplication.vent.on(i.events.REMOVE_SYMPTOMS,function(t){e.collection.add(t),e.collection.sort(),o.defer(function(){t.get("focusElement").selector.indexOf("#symptoms-ul")>-1?$("#symptom"+t.get("count")+"-"+t.get("IEN")+" > a").focus():$(t.get("focusElement")).find(".xbutton")[0].focus()})})},childView:r,tagName:"ul",className:"nav nav-pills nav-stacked",attributes:{id:"symptoms-ul",role:"menu"}});return c});