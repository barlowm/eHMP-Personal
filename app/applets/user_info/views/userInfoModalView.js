define(["backbone","marionette","underscore","jquery","app/applets/user_info/appletUtil","app/applets/user_info/eventHandler","hbs!app/applets/user_info/templates/userInfoModalTemplate","hbs!app/applets/user_info/templates/userInfoRolesRegionTemplate","hbs!app/applets/user_info/templates/userInfoModalFooterTemplate"],function(e,t,l,o,n,a,s,i,r){var p={},d={},u={},h={};d.createModalView=function(t,n){var s=new ADK.UI.Modal({view:new m({model:t,navHeader:!1,roles:n}),options:{size:"large",title:"User",footerView:e.Marionette.ItemView.extend({template:r})},events:{"click #modal-save-button":function(e){var n={},s=[],i=[];l.each(o(".allRoles option:selected"),function(e){"none"!==e.value&&"None"!==e.value&&(s.push(e.innerHTML),i.push(e.value))}),n.html=s,n.values=i;var r=t.get("roles");r.val=n.values,a.editUserRoles(t,r)}}});return s};var v=e.Marionette.ItemView.extend({template:i,initialize:function(e){this.parentView=e.parentView}}),m=e.Marionette.LayoutView.extend({template:s,regions:{rolesRegion:".rolesRegion"},events:{"change .allRoles":"changeDesignatedRolesInModalView"},initialize:function(t){this.model=t.model,u=this.model.get("rolesLabels"),h=this.model.get("roles").val;var l=t.roles;this.rolesRegionView=new v({parentView:this,model:new e.Model({rolesList:l.data,initialRolesLabels:u})})},onShow:function(){this.rolesRegion.show(this.rolesRegionView)},changeDesignatedRolesInModalView:function(){if(p=this.getSelectedRoles(),0===p.values.length){this.$el.find(".designatedRoles").html("None");var e=this.$el.find(".allRoles");e.find(".none").prop("selected",!0)}else this.$el.find(".designatedRoles").html(p.html.join(", "));n.compareArrays(p.values,h)?o("#modal-save-button").prop("disabled",!0):o("#modal-save-button").prop("disabled",!1)},getSelectedRoles:function(){var e=[],t=[];return l.each(o(".allRoles option:selected"),function(l){"none"!==l.value&&"None"!==l.value&&(e.push(l.innerHTML),t.push(l.value))}),p.html=e,p.values=t,p}});return d});