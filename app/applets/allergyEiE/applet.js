define(["underscore","handlebars","hbs!app/applets/allergyEiE/assets/templates/allergyEiETemplate","hbs!app/applets/allergyEiE/assets/templates/allergyEiEFooterTemplate"],function(e,t,i,n){var o=Backbone.Marionette.ItemView.extend({template:n,events:{"click #submit":"save"},save:function(){this.bodyView.save()}}),s={id:"allergyEiE",getRootView:function(){return Backbone.Marionette.ItemView.extend({template:i,initialize:function(){this.model=new Backbone.Model({})},events:{"click #submit":"save","change #comments":"update"},update:function(e){this.model.set({comments:$(e.currentTarget).val()})},save:function(e){var t=this,i=ADK.PatientRecordService.getCurrentPatient(),n={data:JSON.stringify({isRemove:!0,uid:this.model.get("uid"),comments:this.model.get("comments")}),contentType:"application/json",error:function(e,t){console.log(t,"FAIL")},success:function(e,i){ADK.UI.Modal.hide(),setTimeout(function(){t.model.get("gridView").refresh({})},2e3)}};this.model.id="destroy",this.model.url=ADK.ResourceService.buildUrl("write-back-allergy-error-save",{pid:i.get("icn")||i.get("pid")||i.get("id")}),this.model.save(null,n)},showModal:function(e,i){this.model.set(i);var n=o.extend({bodyView:this}),s=Backbone.Marionette.ItemView.extend({template:t.compile("<button type='button' class='close' data-dismiss='modal'><span aria-hidden='true'>Ã—</span><span class='sr-only'>Close</span></button><h4 class='modal-title'>Mark Adverse Reaction to <strong> {{allergen}} </strong> as Entered in Error</h4>"),initialize:function(){this.model.set("allergen",this.model.get("allergen").toUpperCase())}}),a={title:"Mark Adverse Reaction",headerView:s.extend({model:this.model}),footerView:n},l=new ADK.UI.Modal({view:this,options:a});l.show()}})}};return function(){var e=ADK.Messaging.getChannel("allergyEiERequestChannel");e.reply("allergyEiEModal",function(){var e=s.getRootView(),t=$.Deferred();return t.resolve({view:new e}),t.promise()})}(),s});