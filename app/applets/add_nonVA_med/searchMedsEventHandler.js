define(["app/applets/add_nonVA_med/utils/searchUtil","app/applets/add_nonVA_med/models/MedsCollection"],function(e,n){"use strict";var t,o,a=[],i=!1,d={setView:function(e){t=e.medsView,o=e.errorView},getView:function(){return t},medsEventHandler:function(r){if(i&&"undefined"!=typeof r)a.push($(r.target).val());else{var s="";s=a.length>0?a.shift():$(r.target).val(),d.fetchOptions={reset:!0,data:$.param({filter:'and(ilike(name,"%'+s+'%"),eq("types[].type","NON-VA MEDS"))'}),error:function(n){e.enableLoadingIndicator(!1),i=!1,o&&o.addError(n.responseText)},success:function(n){t.collection.reset(n.toJSON()),e.enableLoadingIndicator(!1),a.length>0?d.medsEventHandler(void 0):(i=!1,$("#meds-loading-annoucement").hide(),$("#meds-loading-annoucement").text("Lookup complete"),$("#meds-loading-annoucement").show())}},i=!0,(new n).fetch(d.fetchOptions),e.enableLoadingIndicator(!0),o&&o.clearErrors()}}};return d});