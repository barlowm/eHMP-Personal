define(["backbone","marionette","underscore","app/applets/documents/appletHelper","app/applets/documents/detail/addendaView","hbs!app/applets/documents/detail/complex/complexDetailWrapperTemplate","hbs!app/applets/documents/detail/complex/resultsTemplate","hbs!app/applets/documents/detail/complex/resultLinkTemplate","hbs!app/applets/documents/detail/complex/resultDocTemplate","app/applets/documents/detail/dodComplexNoteUtil"],function(e,t,o,i,l,n,s,c,d,a){"use strict";var r=e.Marionette.ItemView.extend({template:c}),h=e.Marionette.LayoutView.extend({template:d,regions:{addendaView:".document-detail-addenda-region"},onRender:function(){this.addendaView.show(new l({model:this.model}))}}),u=e.Marionette.CollectionView.extend({childView:r}),p=e.Marionette.CollectionView.extend({className:"complexDocDetail",childView:h}),m=e.Marionette.LayoutView.extend({template:s,events:{"click .detail-result-link":"onClickResultLink","keydown .detail-result-link":"onEnter"},regions:{resultLinksRegion:".result-links-region",resultDocsRegion:".result-docs-region"},initialize:function(e){this.resultDocCollection=e.resultDocCollection},onEnter:function(e){(13===e.keyCode||32===e.keyCode)&&(e.preventDefault(),$(e.target).click())},onClickResultLink:function(e){var t=$(e.target).attr("data-doc-uid"),o=this.$el.find('.resultDoc[data-doc-uid="'+t+'"]');o.length>0&&(i.scrollToResultDoc($(e.target),o),o.find("*[tabindex]").first().focus())},onRender:function(){this.resultLinksRegion.show(new u({collection:this.resultDocCollection})),this.resultDocsRegion.show(new p({collection:this.resultDocCollection}))}}),g=e.Marionette.LayoutView.extend({template:n,regions:{addendaRegion:".document-detail-addenda-region",resultsRegion:"#results-region",childrenRegion:"#children-region"},initialize:function(e){this.childDocCollection=e.childDocCollection,this.resultDocCollection=e.resultDocCollection,this.hasChildDocuments()&&this.listenToOnce(this.childDocCollection,"all",this.onChildDocsReady),this.hasResultDocuments()&&this.listenToOnce(this.resultDocCollection,"all",this.onResultDocsReady)},hasResultDocuments:function(){return this.model.get("results")&&this.model.get("results").length>0},hasChildDocuments:function(){return null!==this.childDocCollection&&void 0!==this.childDocCollection},onResultDocsReady:function(){this.resultDocCollection.isEmpty()?this.resultsRegion.reset():this.resultsRegion.show(new m({resultDocCollection:this.resultDocCollection,model:new e.Model({regionTitle:"Results"})})),ADK.Messaging.getChannel("search").trigger("documentsLoaded",this.$el)},onChildDocsReady:function(){this.childDocCollection.isEmpty()?this.childrenRegion.reset():this.childrenRegion.show(new m({resultDocCollection:this.childDocCollection,model:new e.Model({regionTitle:"Child Documents"})})),ADK.Messaging.getChannel("search").trigger("documentsLoaded",this.$el)},onRender:function(){this.addendaRegion.show(new l({model:this.model})),this.hasChildDocuments()&&this.childrenRegion.show(ADK.Views.Loading.create()),this.hasResultDocuments()&&this.resultsRegion.show(ADK.Views.Loading.create())},onShow:function(){this.model.get("dodComplexNoteContent")&&a.showContent(this.model)}});return g});