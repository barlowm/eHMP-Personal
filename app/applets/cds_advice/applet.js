define(["app/applets/cds_advice/util","app/applets/cds_advice/modal/default/defaultModal","app/applets/cds_advice/modal/error/errorModal","app/applets/cds_advice/modal/advice/adviceModal","app/applets/cds_advice/modal/reminder/reminderModal","app/applets/cds_advice/modal/loading/loadingModal","hbs!app/applets/cds_advice/list/priorityTemplate"],function(e,t,i,a,l,r,o,n){"use strict";var d,c,s={name:"priorityText",label:"Priority",cell:"handlebars",template:o,hoverTip:"clinicalreminders_priority"},p={name:"typeText",label:"Type",cell:"string",hoverTip:"clinicalreminders_type"},m={name:"title",label:"Title",cell:"string",hoverTip:"clinicalreminders_title"},u={name:"dueDateFormatted",label:"Due Date",cell:"string",hoverTip:"clinicalreminders_duedate"},y={name:"doneDateFormatted",label:"Done Date",cell:"string",hoverTip:"clinicalreminders_donedate"},h=[s,m,p,u],f=[s,m,p,u,y],v="none",D={pageable:!0,resourceTitle:"cds-advice-list",cache:!1,criteria:{use:v,cache:!0},viewModel:{parse:function(t){return t.typeText=e.getTypeText(t.type),t.priorityText=e.getPriorityText(t.priority),t.priorityCSS=e.getPriorityCSS(t.priority),t.dueDateFormatted=e.formatDate(t.dueDate),t.doneDateFormatted=e.formatDate(t.doneDate),t}}},T=ADK.Applets.BaseGridApplet,g=T.extend({localId:null,initialize:function(e){var t=this;c=T.prototype,D.pageable=!e.appletConfig.fullScreen;var i={summaryColumns:h,fullScreenColumns:f,enableModal:!0,filterEnabled:!0,onClickRow:function(e,i){t.onClickRowHandler(e,i)},collection:ADK.PatientRecordService.createEmptyCollection(D)};t.dataGridOptions=i,c.initialize.call(t,e)},onRender:function(){c.onRender.apply(this,arguments),ADK.PatientRecordService.fetchCollection(D,this.dataGridOptions.collection)},refresh:function(){D.criteria.cache=!1,c.refresh.apply(this,arguments),D.criteria.cache=!0},onClickRowHandler:function(t,i){var a=this;t.get("details")?a.showDetails(t):(r.show(t,e.getTypeText(t.get("type"))),a.getDetails(t))},getDetails:function(t){var a=this,l={resourceTitle:"cds-advice-detail",criteria:{id:t.get("id"),use:v}},r=ADK.PatientRecordService.fetchModel(l);d=r.fetch().promise(),d.fail(function(e,a){i.show(t.get("title"))}),r.on("sync",function(){r.set("detail",e.formatDetailText(r.get("detail"))),t.set("details",r.toJSON()),a.showDetails(t)})},showDetails:function(i){switch(i.get("type")){case e.ADVICE_TYPE.REMINDER:l.show(i);break;case e.ADVICE_TYPE.ADVICE:a.show(i);break;default:t.show(i)}}}),w={id:"cds_advice",viewTypes:[{type:"summary",view:g.extend({columnsViewType:"summary"}),chromeEnabled:!0},{type:"expanded",view:g.extend({columnsViewType:"expanded"}),chromeEnabled:!0}],defaultViewType:"summary"};return w});