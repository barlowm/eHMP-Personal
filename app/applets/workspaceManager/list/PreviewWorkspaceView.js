define(["underscore","backbone","marionette","gridster","hbs!app/applets/workspaceManager/list/previewWorkspaceTemplate"],function(e,i,t,r,s){"use strict";var n=i.Marionette.ItemView.extend({template:s,initialize:function(e){this.model=new i.Model,this.model.set({screenId:e.screenId,screenTitle:e.screenTitle});var t=ADK.UserDefinedScreens.getGridsterTemplateForPreview(ADK.ADKApp[e.screenId]);"documents-list"===e.screenId&&(t=this.getTemplateForDocumentsList()),this.model.set("gridsterTemplate",t)},getTemplateForDocumentsList:function(){return'<div id="gridsterPreview" class="gridster"><ul><li data-row="1" data-col="1" data-sizex="12" data-sizey="8" ><h4 class="applet-title">Documents</h4><p>expanded</p></li></ul></div>'},setContinerHeight:function(){this.$el.find(".workspaceManagerForms").height($(window).height()+"px")},onRender:function(){var e=this;this.setContinerHeight(),$(window).on("resize.previewworkspaceview",function(){e.setContinerHeight(),e.setGridsterBaseDimension()})},onShow:function(){this.initGridster()},getHighestGridsterCol:function(){return Math.max(12,this.gridster.get_highest_occupied_cell().col)},getGridsterDimension:function(){var e=this.$el.find(".gridsterContainer"),i=e.width(),t=e.height(),r=this.getHighestGridsterCol(),s=Math.floor(i/r)-10,n=.9*t/12-10;return[s,n]},setGridsterBaseDimension:function(){this.gridster.resize_widget_dimensions({widget_base_dimensions:this.getGridsterDimension()})},initGridster:function(){this.gridster=this.$el.find(".gridsterContainer ul").gridster({namespace:"#gridsterPreview",widget_selector:"li",widget_base_dimensions:[1,1],widget_margins:[5,5],helper:"clone",avoid_overlapped_widgets:!0,autogrow_cols:!0,min_cols:100,resize:{enabled:!1},draggable:{ignore_dragging:function(){return!0}}}).data("gridster"),this.gridster&&this.setGridsterBaseDimension()},onBeforeDestroy:function(){$(window).off("resize.previewworkspaceview"),this.gridster&&this.gridster.destroy()}});return n});